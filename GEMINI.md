# GEMINI.md

## プロジェクトの目的

- 距離センサー VL53L0X の Python ドライバー
- **Raspberry Pi Zero 2W** のような低スペックの環境でも、ちゃんと測定できること。
- **pigpio**を使うこと。
- ライブラリとして利用できるだけでなく、CLIで、動作確認やデモが行えるようにする。

### このプロジェクトに参考になる情報

- [Pololu社:Arduino用 C++ ソースコード](https://github.com/pololu/vl53l0x-arduino)
- https://github.com/cassou/VL53L0X_rasp
- https://github.com/johnbryanmoore/VL53L0X_rasp_python


## プロジェクト全体のルール

- **`git commit`は、ユーザーが行う**
- コミットが必要だと思われるタイミングで、ユーザーにコミットを促す。
  このとき、一行でe英語の簡潔なコミットメッセージの案を提示する。

- **プロジェクトの設定・管理**は、 `pyproject.toml`で行う。
- **コマンドの実行**は、`uv run ...`を使う。

- **リンティング**は、以下のコマンドを実行する。
    - `uv run ruff check ....`
    - `uv run mypy ....`
    - `uv run pyright ....`
- **テストプログラム**は、 `tests` ディレクトリ以下に番号をつけて作成する。
- **テストの実行**は、 `uv run python -m pytest -v ...`を使う

- **確実なファイル更新方法**: 新しくファイルを作成して、差し替えるのが確実


## コーディング・ルール

- ソースコード内のコメントは、基本的に日本語
- ソースコードの一行の長さは、78文字以内
- デバッグログは、`my_logger.py` の `get_logger()`を使うこと。
- `my_logger.py`は、変更しないこと。


## タスクの計画と実行について: `ToDo.md` `Tasks.md`

- まず、プロジェクトのトップディレクトリに、`ToDo.md` `Tasks.md`があるか確認。
    - どちらもない場合は、何もせず、ユーザーに何をするか確認する。

- `ToDo.md` `Tasks.md`のどちらかが存在する場合は、以下のルールに従う。

- なにか作業を行う前には、**必ず** `Task.md`を以下のルールで作成して、**必ず** タスクを実行していいか、ユーザーに問い合わせ、'go ahead'と言われるまで実行しない。


### `Task.md` が存在する場合

- `Tasks.md` に従って、チェックがないタスクから、順番に実行する。
- ソースコードを変更したら、リンティングを行うとともに、テストプログラムを作成・編集して動作を確認する。
- タスク項目が一つ完了したら、`Tasks.md`の該当項目にチェックを入れる。
- 追加タスクが必要になったら、`Tasks.md`の内容も更新する。
- `Tasks.md`の内容を変更した場合は、**必ず** タスクを実行していいか、ユーザーに問い合わせ、'go ahead'と言われるまで実行しない。
- `Tasks.md`がすべてチェックできたら、以下を行う。
  1. `ToDo.md` を確認して、完了した内容にはチェックを入れる。
  2. `Tasks.md` を `yyyymmdd-HHMM-Tasks-done.md` の形式にリネームして、`archives`ディレクトリに移動する(`yyyymmdd`は日付、`HHMM`は時刻)。`uv run rename_task.py`を実行してもよい。


### `Task.md` が存在しない場合

- `ToDo.md` の内容を確認して、**優先項目**でチェックされてない項目で、先頭の項目の内容を理解し、実行計画を立案し、詳細なタスクに分解し、`Tasks.md` にチェックリストを作成する。
- 基本的に、`ToDo.md` の項目一つについて、Task.mdを一つずつ作成して、ステップバイステップで作業を進める。
- `Tasks.md` を作成したら、**必ず** 実行していいか、ユーザーに問い合わせ、'go ahead'と言われるまで実行しない。

